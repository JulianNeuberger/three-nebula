import { PI } from '../constants';
import Util from '../utils/Util';
import Vector3D from '../math/Vector3D';
import Zone from './Zone';
import { ZONE_TYPE_SPHERE as type } from './types';
/**
 * A spherical zone for particles to be emitted within.
 *
 */

export default class SphereZone extends Zone {
  /**
   * @constructs {SphereZone}
   *
   * @param {number} centerX - the sphere's center x coordinate
   * @param {number} centerY - the sphere's center y coordinate
   * @param {number} centerZ - the sphere's center z coordinate
   * @param {number} radius - the sphere's radius value
   * @return void
   */
  constructor(centerX, centerY, centerZ, radius) {
    super(type); // TODO see below, these should probably be assigned properly
    // eslint-disable-next-line

    let x, y, z, r;

    if (Util.isUndefined(centerY, centerZ, radius)) {
      x = y = z = 0;
      r = centerX || 100;
    } else {
      x = centerX; // eslint-disable-next-line

      y = centerY; // eslint-disable-next-line

      z = centerZ;
      r = radius;
    }

    this.x = x; // TODO shouldn't this be set to y?

    this.y = x; // TODO shouldn't this be set to z?

    this.z = x;
    this.radius = r;
    this.the = this.phi = 0;
  }
  /**
   * Returns true to indicate this is a SphereZone.
   *
   * @return {boolean}
   */


  isSphereZone() {
    return true;
  }
  /**
   * Sets the particle to dead if the particle collides with the sphere.
   *
   * @param {object} particle
   * @return void
   */


  _dead(particle) {
    var d = particle.position.distanceTo(this);
    if (d - particle.radius > this.radius) particle.dead = true;
  }
  /**
   * Warns that this zone does not support the _cross method.
   *
   * @return void
   */


  _cross() {
    console.warn(`${this.constructor.name} does not support the _cross method`);
  }

}

SphereZone.prototype.getPosition = function () {
  var tha, phi, r;
  return function () {
    this.random = Math.random();
    r = this.random * this.radius;
    tha = PI * Math.random(); //[0-pi]

    phi = PI * 2 * Math.random(); //[0-2pi]

    this.vector.x = this.x + r * Math.sin(tha) * Math.cos(phi);
    this.vector.y = this.y + r * Math.sin(phi) * Math.sin(tha);
    this.vector.z = this.z + r * Math.cos(tha);
    return this.vector;
  };
}();

SphereZone.prototype._bound = function () {
  var normal = new Vector3D(),
      v = new Vector3D(),
      k;
  return function (particle) {
    var d = particle.position.distanceTo(this);

    if (d + particle.radius >= this.radius) {
      normal.copy(particle.position).sub(this).normalize();
      v.copy(particle.velocity);
      k = 2 * v.dot(normal);
      particle.velocity.sub(normal.scalar(k));
    }
  };
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy96b25lL1NwaGVyZVpvbmUuanMiXSwibmFtZXMiOlsiUEkiLCJVdGlsIiwiVmVjdG9yM0QiLCJab25lIiwiWk9ORV9UWVBFX1NQSEVSRSIsInR5cGUiLCJTcGhlcmVab25lIiwiY29uc3RydWN0b3IiLCJjZW50ZXJYIiwiY2VudGVyWSIsImNlbnRlcloiLCJyYWRpdXMiLCJ4IiwieSIsInoiLCJyIiwiaXNVbmRlZmluZWQiLCJ0aGUiLCJwaGkiLCJpc1NwaGVyZVpvbmUiLCJfZGVhZCIsInBhcnRpY2xlIiwiZCIsInBvc2l0aW9uIiwiZGlzdGFuY2VUbyIsImRlYWQiLCJfY3Jvc3MiLCJjb25zb2xlIiwid2FybiIsIm5hbWUiLCJwcm90b3R5cGUiLCJnZXRQb3NpdGlvbiIsInRoYSIsInJhbmRvbSIsIk1hdGgiLCJ2ZWN0b3IiLCJzaW4iLCJjb3MiLCJfYm91bmQiLCJub3JtYWwiLCJ2IiwiayIsImNvcHkiLCJzdWIiLCJub3JtYWxpemUiLCJ2ZWxvY2l0eSIsImRvdCIsInNjYWxhciJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsRUFBVCxRQUFtQixjQUFuQjtBQUNBLE9BQU9DLElBQVAsTUFBaUIsZUFBakI7QUFDQSxPQUFPQyxRQUFQLE1BQXFCLGtCQUFyQjtBQUNBLE9BQU9DLElBQVAsTUFBaUIsUUFBakI7QUFDQSxTQUFTQyxnQkFBZ0IsSUFBSUMsSUFBN0IsUUFBeUMsU0FBekM7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFDQSxlQUFlLE1BQU1DLFVBQU4sU0FBeUJILElBQXpCLENBQThCO0FBQzNDO0FBQ0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNFSSxFQUFBQSxXQUFXLENBQUNDLE9BQUQsRUFBVUMsT0FBVixFQUFtQkMsT0FBbkIsRUFBNEJDLE1BQTVCLEVBQW9DO0FBQzdDLFVBQU1OLElBQU4sRUFENkMsQ0FHN0M7QUFDQTs7QUFDQSxRQUFJTyxDQUFKLEVBQU9DLENBQVAsRUFBVUMsQ0FBVixF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UUFBSixFQUFiO0FBQUEsTUFDRXNDLENBQUMsR0FBRyxJQUFJdEMsUUFBSixFQUROO0FBQUEsTUFFRXVDLENBRkY7QUFJQSxTQUFPLFVBQVNwQixRQUFULEVBQW1CO0FBQ3hCLFFBQUlDLENBQUMsR0FBR0QsUUFBUSxDQUFDRSxRQUFULENBQWtCQyxVQUFsQixDQUE2QixJQUE3QixDQUFSOztBQUVBLFFBQUlGLENBQUMsR0FBR0QsUUFBUSxDQUFDVixNQUFiLElBQXVCLEtBQUtBLE1BQWhDLEVBQXdDO0FBQ3RDNEIsTUFBQUEsTUFBTSxDQUNIRyxJQURILENBQ1FyQixRQUFRLENBQUNFLFFBRGpCLEVBRUdvQixHQUZILENBRU8sSUFGUCxFQUdHQyxTQUhIO0FBSUFKLE1BQUFBLENBQUMsQ0FBQ0UsSUFBRixDQUFPckIsUUFBUSxDQUFDd0IsUUFBaEI7QUFDQUosTUFBQUEsQ0FBQyxHQUFHLElBQUlELENBQUMsQ0FBQ00sR0FBRixDQUFNUCxNQUFOLENBQVI7QUFDQWxCLE1BQUFBLFFBQVEsQ0FBQ3dCLFFBQVQsQ0FBa0JGLEdBQWxCLENBQXNCSixNQUFNLENBQUNRLE1BQVAsQ0FBY04sQ0FBZCxDQUF0QjtBQUNEO0FBQ0YsR0FaRDtBQWFELENBbEI2QixFQUE5QiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBJIH0gZnJvbSAnLi4vY29uc3RhbnRzJztcclxuaW1wb3J0IFV0aWwgZnJvbSAnLi4vdXRpbHMvVXRpbCc7XHJcbmltcG9ydCBWZWN0b3IzRCBmcm9tICcuLi9tYXRoL1ZlY3RvcjNEJztcclxuaW1wb3J0IFpvbmUgZnJvbSAnLi9ab25lJztcclxuaW1wb3J0IHsgWk9ORV9UWVBFX1NQSEVSRSBhcyB0eXBlIH0gZnJvbSAnLi90eXBlcyc7XHJcblxyXG4vKipcclxuICogQSBzcGhlcmljYWwgem9uZSBmb3IgcGFydGljbGVzIHRvIGJlIGVtaXR0ZWQgd2l0aGluLlxyXG4gKlxyXG4gKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3BoZXJlWm9uZSBleHRlbmRzIFpvbmUge1xyXG4gIC8qKlxyXG4gICAqIEBjb25zdHJ1Y3RzIHtTcGhlcmVab25lfVxyXG4gICAqXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IGNlbnRlclggLSB0aGUgc3BoZXJlJ3MgY2VudGVyIHggY29vcmRpbmF0ZVxyXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjZW50ZXJZIC0gdGhlIHNwaGVyZSdzIGNlbnRlciB5IGNvb3JkaW5hdGVcclxuICAgKiBAcGFyYW0ge251bWJlcn0gY2VudGVyWiAtIHRoZSBzcGhlcmUncyBjZW50ZXIgeiBjb29yZGluYXRlXHJcbiAgICogQHBhcmFtIHtudW1iZXJ9IHJhZGl1cyAtIHRoZSBzcGhlcmUncyByYWRpdXMgdmFsdWVcclxuICAgKiBAcmV0dXJuIHZvaWRcclxuICAgKi9cclxuICBjb25zdHJ1Y3RvcihjZW50ZXJYLCBjZW50ZXJZLCBjZW50ZXJaLCByYWRpdXMpIHtcclxuICAgIHN1cGVyKHR5cGUpO1xyXG5cclxuICAgIC8vIFRPRE8gc2VlIGJlbG93LCB0aGVzZSBzaG91bGQgcHJvYmFibHkgYmUgYXNzaWduZWQgcHJvcGVybHlcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxyXG4gICAgbGV0IHgsIHksIHosIHI7XHJcblxyXG4gICAgaWYgKFV0aWwuaXNVbmRlZmluZWQoY2VudGVyWSwgY2VudGVyWiwgcmFkaXVzKSkge1xyXG4gICAgICB4ID0geSA9IHogPSAwO1xyXG4gICAgICByID0gY2VudGVyWCB8fCAxMDA7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB4ID0gY2VudGVyWDtcclxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXHJcbiAgICAgIHkgPSBjZW50ZXJZO1xyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmVcclxuICAgICAgeiA9IGNlbnRlclo7XHJcbiAgICAgIHIgPSByYWRpdXM7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy54ID0geDtcclxuXHJcbiAgICAvLyBUT0RPIHNob3VsZG4ndCB0aGlzIGJlIHNldCB0byB5P1xyXG4gICAgdGhpcy55ID0geDtcclxuXHJcbiAgICAvLyBUT0RPIHNob3VsZG4ndCB0aGlzIGJlIHNldCB0byB6P1xyXG4gICAgdGhpcy56ID0geDtcclxuICAgIHRoaXMucmFkaXVzID0gcjtcclxuICAgIHRoaXMudGhlID0gdGhpcy5waGkgPSAwO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmV0dXJucyB0cnVlIHRvIGluZGljYXRlIHRoaXMgaXMgYSBTcGhlcmVab25lLlxyXG4gICAqXHJcbiAgICogQHJldHVybiB7Ym9vbGVhbn1cclxuICAgKi9cclxuICBpc1NwaGVyZVpvbmUoKSB7XHJcbiAgICByZXR1cm4gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFNldHMgdGhlIHBhcnRpY2xlIHRvIGRlYWQgaWYgdGhlIHBhcnRpY2xlIGNvbGxpZGVzIHdpdGggdGhlIHNwaGVyZS5cclxuICAgKlxyXG4gICAqIEBwYXJhbSB7b2JqZWN0fSBwYXJ0aWNsZVxyXG4gICAqIEByZXR1cm4gdm9pZFxyXG4gICAqL1xyXG4gIF9kZWFkKHBhcnRpY2xlKSB7XHJcbiAgICB2YXIgZCA9IHBhcnRpY2xlLnBvc2l0aW9uLmRpc3RhbmNlVG8odGhpcyk7XHJcblxyXG4gICAgaWYgKGQgLSBwYXJ0aWNsZS5yYWRpdXMgPiB0aGlzLnJhZGl1cykgcGFydGljbGUuZGVhZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBXYXJucyB0aGF0IHRoaXMgem9uZSBkb2VzIG5vdCBzdXBwb3J0IHRoZSBfY3Jvc3MgbWV0aG9kLlxyXG4gICAqXHJcbiAgICogQHJldHVybiB2b2lkXHJcbiAgICovXHJcbiAgX2Nyb3NzKCkge1xyXG4gICAgY29uc29sZS53YXJuKGAke3RoaXMuY29uc3RydWN0b3IubmFtZX0gZG9lcyBub3Qgc3VwcG9ydCB0aGUgX2Nyb3NzIG1ldGhvZGApO1xyXG4gIH1cclxufVxyXG5cclxuU3BoZXJlWm9uZS5wcm90b3R5cGUuZ2V0UG9zaXRpb24gPSAoZnVuY3Rpb24oKSB7XHJcbiAgdmFyIHRoYSwgcGhpLCByO1xyXG5cclxuICByZXR1cm4gZnVuY3Rpb24oKSB7XHJcbiAgICB0aGlzLnJhbmRvbSA9IE1hdGgucmFuZG9tKCk7XHJcblxyXG4gICAgciA9IHRoaXMucmFuZG9tICogdGhpcy5yYWRpdXM7XHJcbiAgICB0aGEgPSBQSSAqIE1hdGgucmFuZG9tKCk7IC8vWzAtcGldXHJcbiAgICBwaGkgPSBQSSAqIDIgKiBNYXRoLnJhbmRvbSgpOyAvL1swLTJwaV1cclxuXHJcbiAgICB0aGlzLnZlY3Rvci54ID0gdGhpcy54ICsgciAqIE1hdGguc2luKHRoYSkgKiBNYXRoLmNvcyhwaGkpO1xyXG4gICAgdGhpcy52ZWN0b3IueSA9IHRoaXMueSArIHIgKiBNYXRoLnNpbihwaGkpICogTWF0aC5zaW4odGhhKTtcclxuICAgIHRoaXMudmVjdG9yLnogPSB0aGlzLnogKyByICogTWF0aC5jb3ModGhhKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy52ZWN0b3I7XHJcbiAgfTtcclxufSkoKTtcclxuXHJcblNwaGVyZVpvbmUucHJvdG90eXBlLl9ib3VuZCA9IChmdW5jdGlvbigpIHtcclxuICB2YXIgbm9ybWFsID0gbmV3IFZlY3RvcjNEKCksXHJcbiAgICB2ID0gbmV3IFZlY3RvcjNEKCksXHJcbiAgICBrO1xyXG5cclxuICByZXR1cm4gZnVuY3Rpb24ocGFydGljbGUpIHtcclxuICAgIHZhciBkID0gcGFydGljbGUucG9zaXRpb24uZGlzdGFuY2VUbyh0aGlzKTtcclxuXHJcbiAgICBpZiAoZCArIHBhcnRpY2xlLnJhZGl1cyA+PSB0aGlzLnJhZGl1cykge1xyXG4gICAgICBub3JtYWxcclxuICAgICAgICAuY29weShwYXJ0aWNsZS5wb3NpdGlvbilcclxuICAgICAgICAuc3ViKHRoaXMpXHJcbiAgICAgICAgLm5vcm1hbGl6ZSgpO1xyXG4gICAgICB2LmNvcHkocGFydGljbGUudmVsb2NpdHkpO1xyXG4gICAgICBrID0gMiAqIHYuZG90KG5vcm1hbCk7XHJcbiAgICAgIHBhcnRpY2xlLnZlbG9jaXR5LnN1Yihub3JtYWwuc2NhbGFyKGspKTtcclxuICAgIH1cclxuICB9O1xyXG59KSgpO1xyXG4iXX0=